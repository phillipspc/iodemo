<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <script src="https://unpkg.com/stimulus/dist/stimulus.umd.js"></script>
    <style media="screen">
      .canvas {
        background-color: black;
      }
    </style>
  </head>
  <body data-controller="game">
    <div>
      <h4>Game object</h4>
      <p data-target="game.state"></p>
    </div>
    <script>
      (() => {
        const application = Stimulus.Application.start()

        application.register("game", class extends Stimulus.Controller {
          static get targets() {
            return [ "state" ]
          }

          connect() {
            this.state = {
              1: { x: 0, y: 0 },
              2: { x: 200, y: 200 }
            }

            document.addEventListener("keydown", e => {
              switch (e.key) {
                case "w":
                  this.movePlayerAndUpdate(1, 0, -1)
                  break;
                case "a":
                  this.movePlayerAndUpdate(1, -1, 0)
                  break;
                case "s":
                  this.movePlayerAndUpdate(1, 0, 1)
                  break;
                case "d":
                  this.movePlayerAndUpdate(1, 1, 0)
                  break;
                case "ArrowUp":
                  this.movePlayerAndUpdate(2, 0, -1)
                  break;
                case "ArrowLeft":
                  this.movePlayerAndUpdate(2, -1, 0)
                  break;
                case "ArrowDown":
                  this.movePlayerAndUpdate(2, 0, 1)
                  break;
                case "ArrowRight":
                  this.movePlayerAndUpdate(2, 1, 0)
                  break;
                default:
                  break;
              }
            })
          }

          movePlayerAndUpdate(playerNum, xDiff, yDiff) {
            this.state[playerNum] = {
              x: this.state[playerNum].x += xDiff,
              y: this.state[playerNum].y += yDiff
            }
            this.stateTarget.innerHTML = JSON.stringify(this.state)
          }
        })
      })()
    </script>
  </body>
</html>
